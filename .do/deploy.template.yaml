spec:
  name: loadpartner-tms
  services:
    - name: web
      git:
        branch: do-deploy-button
        repo_clone_url: https://github.com/loadpartner/tms.git
      build_command: |
        apt-get update
        apt-get install -y sqlite3 libsqlite3-dev gnupg gosu curl ca-certificates zip unzip git
        apt-get install -y php8.4-cli php8.4-dev php8.4-pgsql php8.4-sqlite3 php8.4-gd php8.4-curl php8.4-mongodb php8.4-imap php8.4-mysql php8.4-mbstring php8.4-xml php8.4-zip php8.4-bcmath php8.4-soap php8.4-intl php8.4-readline php8.4-ldap php8.4-msgpack php8.4-igbinary php8.4-redis php8.4-memcached php8.4-pcov php8.4-imagick
      run_command: |
        cp .env.example .env
        composer install
        php artisan key:generate
        php artisan migrate
        npm install
        npm run build
        heroku-php-apache2 public/
      environment_slug: php